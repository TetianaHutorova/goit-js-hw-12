{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export default function createMarkup(arr = []) {\r\n  const defaultValues = {\r\n    webformatURL:\r\n      'https://salonlfc.com/wp-content/uploads/2018/01/image-not-found-scaled-1150x647.png',\r\n    tags: '',\r\n    largeImageURL:\r\n      'https://salonlfc.com/wp-content/uploads/2018/01/image-not-found-scaled-1150x647.png',\r\n    likes: 0,\r\n    views: 0,\r\n    comments: 0,\r\n    downloads: 0,\r\n  };\r\n  return arr\r\n    .map(\r\n      ({\r\n        webformatURL,\r\n        tags,\r\n        largeImageURL,\r\n        likes,\r\n        views,\r\n        comments,\r\n        downloads,\r\n      } = defaultValues) => `<li class=\"js-item item\"><a  href='${largeImageURL}'>\r\n  <img src=\"${webformatURL}\" alt=\"${tags}\" data-largeImageURL=\"${largeImageURL}\" ></a>\r\n  <ul class=\"descriptions\">\r\n    <li class=\"description\" >Likes <span class=\"span\">${likes}</span></li>\r\n    <li class=\"description\">Views <span class=\"span\">${views}</span></li>\r\n    <li class=\"description\">Comments <span class=\"span\">${comments}</span></li>\r\n    <li class=\"description\">Downloads <span class=\"span\">${downloads}</span></li>\r\n  </ul>\r\n</li>`\r\n    )\r\n    .join('');\r\n}\r\n","import axios from 'axios';\r\n\r\nconst URL = 'https://pixabay.com/api/';\r\n\r\nconst parametrs = {\r\n  key: '47002801-76ba89481123b51ee1293cd3a',\r\n  image_type: 'photo',\r\n  orientation: 'horizontal',\r\n  safesearch: true,\r\n };\r\n\r\nexport default async function serviceHandlerSearch(value, page, perPage) {\r\n  try {\r\n    const params = new URLSearchParams({\r\n      ...parametrs,\r\n      q: value,\r\n      page,\r\n      per_page: perPage,\r\n    });\r\n\r\n    const response = await axios(`${URL}?${params}`);\r\n\r\n    return response.data;\r\n  } catch (error) {\r\n    return error;\r\n  }\r\n}\r\n","import iziToast from 'izitoast';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\nimport SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\nimport createMarkup from '/js/render-functions';\r\nimport serviceHandlerSearch from './js/pixabay-api';\r\n\r\nconst refs = {\r\n  form: document.querySelector('.js-form'),\r\n  input: document.querySelector('.js-input'),\r\n  container: document.querySelector('.js-list'),\r\n  loader: document.querySelector('.loader'),\r\n  btnSearch: document.querySelector('.js-btnSearch'),\r\n  btnLoad: document.querySelector('.js-btnLoad'),\r\n};\r\nlet page = 1;\r\nlet value;\r\nconst perPage = 15;\r\n\r\nrefs.form.addEventListener('submit', handlerSearch);\r\nrefs.btnLoad.addEventListener('click', handlerBtnLoad);\r\n\r\nlet lightbox = new SimpleLightbox('.gallery a', {\r\n  captionDelay: 250,\r\n  captionsData: 'alt',\r\n});\r\n\r\nasync function handlerSearch(evt) {\r\n  evt.preventDefault();\r\n  value = evt.target.elements.search.value;\r\n\r\n  if (!value.trim()) {\r\n    return iziToast.error({\r\n      message: 'Please fill in the field!',\r\n      position: 'topRight',\r\n    });\r\n  }\r\n\r\n  displayOffAdd();\r\n\r\n  refs.container.innerHTML = '';\r\n\r\n  try {\r\n    const response = await serviceHandlerSearch(value, page, perPage);\r\n\r\n    if (response.hits.length === 0) {\r\n      throw new Error(\r\n        'Sorry, there are no images matching your search query. Please try again!'\r\n      );\r\n    }\r\n    if (Math.floor(response.totalHits / perPage) < page) {\r\n      displayOffAdd();\r\n\r\n      throw new Error(\r\n        \"We're sorry, but you've reached the end of search results.\"\r\n      );\r\n    }\r\n\r\n    refs.container.innerHTML = createMarkup(response.hits);\r\n\r\n    lightbox.refresh();\r\n    displayOffDelete();\r\n  } catch (error) {\r\n    iziToast.error({\r\n      message: error.message,\r\n      position: 'topRight',\r\n    });\r\n  } finally {\r\n    refs.loader.classList.remove('displayOn');\r\n  }\r\n\r\n  evt.target.reset();\r\n}\r\n\r\nasync function handlerBtnLoad() {\r\n  page += 1;\r\n\r\n  try {\r\n    const response = await serviceHandlerSearch(value, page, perPage);\r\n\r\n    if (response.hits.length === 0) {\r\n      throw new Error(\r\n        'Sorry, there are no images matching your search query. Please try again!'\r\n      );\r\n    }\r\n    if (Math.floor(response.totalHits / perPage) < page) {\r\n      displayOffAdd();\r\n\r\n      throw new Error(\r\n        \"We're sorry, but you've reached the end of search results.\"\r\n      );\r\n    }\r\n\r\n    refs.container.insertAdjacentHTML('beforeend', createMarkup(response.hits));\r\n\r\n    handlerScroll();\r\n\r\n    lightbox.refresh();\r\n  } catch (error) {\r\n    iziToast.error({\r\n      message: error.message,\r\n      position: 'topRight',\r\n    });\r\n  } finally {\r\n    refs.loader.classList.remove('displayOn');\r\n  }\r\n}\r\n\r\nfunction displayOffAdd() {\r\n  refs.btnLoad.classList.add('displayOff');\r\n}\r\n\r\nfunction displayOffDelete() {\r\n  refs.btnLoad.classList.remove('displayOff');\r\n}\r\n\r\nfunction handlerScroll() {\r\n  const domRect = refs.container.getBoundingClientRect();\r\n  window.scrollBy({\r\n    top: domRect.height * 2,\r\n    left: domRect.left,\r\n    behavior: 'smooth',\r\n  });\r\n}\r\n"],"names":["createMarkup","arr","defaultValues","webformatURL","tags","largeImageURL","likes","views","comments","downloads","URL","parametrs","serviceHandlerSearch","value","page","perPage","params","axios","error","refs","handlerSearch","handlerBtnLoad","lightbox","SimpleLightbox","evt","iziToast","displayOffAdd","response","displayOffDelete","handlerScroll","domRect"],"mappings":"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"}